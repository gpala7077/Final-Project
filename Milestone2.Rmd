---
title             : "Final Project: Milestone 2"
shorttitle        : "Milestone 2"
author: 
  - name          : "Mourad Askar, Gerardo Palacios, Joe Paszkiewicz, Ramoskaite, Evelina "
    affiliation   : "1,2"
affiliation:
  - id            : "1"
    institution   : "DSC 425 - Time Series Analysis and Forecasting"
  - id            : "2"
    institution   : "DePaul University"
floatsintext      : yes
figsintext        : yes
figurelist        : yes
tablelist         : yes
footnotelist      : no
linenumbers       : no
mask              : no
draft             : no
documentclass     : "apa6"
classoption       : "man"
output            :  papaja::apa6_pdf
fontsize          : 11pt
header-includes:
  - \usepackage{setspace}
  - \usepackage{booktabs}
  - \usepackage{longtable}
  - \usepackage{array}
  - \usepackage{multirow}
  - \usepackage{wrapfig}
  - \usepackage{float}
  - \usepackage{colortbl}
  - \usepackage{pdflscape}
  - \usepackage{tabu}
  - \usepackage{threeparttable}
  - \usepackage{threeparttablex}
  - \usepackage[normalem]{ulem}
  - \usepackage{makecell}
  - \usepackage{xcolor}
  - \usepackage[backend=biber]{biblatex}
  - \addbibresource{r-references.bib}
  - \usepackage{afterpage}
  - \newcommand{\blandscape}{\begin{landscape}}
  - \newcommand{\elandscape}{\end{landscape}}
editor_options: 
  chunk_output_type: inline
---

\singlespacing
```{r setup, include = FALSE,echo=FALSE}
library("papaja")
library(lubridate)
library(tidyquant)
library(zoo)
library(knitr)
library(kableExtra)
library(xtable)
library(ggfortify)

setwd('/Volumes/MiData/DePaul/DSC425 Labs/Project/Final-Project')

```

# Crypto-Currency and Stock Data
```{r echo=FALSE, message=FALSE, warning=FALSE}
start_date = '2016-10-01'
end_date = '2021-09-30'
tickers = c('SPY','RIOT','COIN','HOOD','BTC-USD','ETH-USD','ADA-USD','DOGE-USD')
getSymbols(tickers, from=start_date, tp=end_date, warnings=FALSE, auto.assign=TRUE)
```



```{r data1, eval=FALSE, warning=FALSE, include=FALSE}
# getSymbols(c('ETH-USD'),from = '2016-10-01' , to='2021-09-30')
# getSymbols(c('RIOT'),from = '2016-10-01' , to='2021-09-30')
#data <- tq_get(c('ETH-USD','BTC-USD','RIOT'),
#               from = '2016-10-01',
#               to = '2021-09-30',
#               get = "stock.prices")

#data <- zoo(data$adjusted,data$date)
#summary(data)
```

```{r, include=T,echo=F,warning=FALSE}
stock = `RIOT`
# Get the column name of the adjusted price
stock.Adjusted.ColName = names(stock)[6]
# Get the stock adjusted values
stockAdj = stock[,stock.Adjusted.ColName]

data <- stockAdj
summary(data)
```

## Graphing the Time Series
Figure 1 shows the time series for Ethereum over the past 5 years. It appears to be a  multiplicative, non-stationary time series with an exponential positive trend that has exploded most recently in 2021.


```{r data2, include=T,echo=T,warning=FALSE,fig.height=3.75,fig.fullwidth=T,fig.align="center"}
autoplot(data)

```

Figure 2, we can see the time series with a log transformation. It has transformed the exponential behavior into something more linear. There still remains a general increasing trend, and appears to be more additive. 
\newpage
```{r data3, echo=T, fig.align="center", fig.fullwidth=T, fig.height=3.75, warning=FALSE, include=T}
autoplot(log(data))

```

Figure 3, we can see the log returns. The plot shows general white noise with a few outliers in 2017 and 2020. 


```{r data4, echo=TRUE, fig.align="center", fig.fullwidth=T, fig.height=3.75, warning=FALSE}
autoplot(diff(log(data)))

```
\newpage
## Auto-correlation

Figure 4 is the ACF plot. Auto-correlation has a strong presence in this time series. The ACF gradually decreases indicating a non-stationary series. 

```{r data5, include=T,echo=T,warning=F,fig.height=3.75,fig.fullwidth=T,fig.align="center"}

acf(log(data), na.action = na.pass)
```

\newpage
## Ljung Box Test

This can be further confirmed by performing the Ljung Box test. At lag 1, the Ljung-Box p-value is close to zero. This indicates that at the 99% confidence, the null hypothesis is rejected and one can conclude that the series is not independently distributed and exhibit serial correlation.

```{r data6, include=T,echo=T,warning=F}

Box.test(log(data), lag = 1, type = "Ljung-Box")
```
\newpage
# Coinbase and Cardano

## Coinbase Summary Statistics
```{r echo=FALSE, warning=FALSE}
stock = `COIN`
# Get the column name of the adjusted price
stock.Adjusted.ColName = names(stock)[6]
# Get the stock adjusted values
stockAdj = stock[,stock.Adjusted.ColName]

stock.COIN <- stockAdj
summary(stock.COIN)
```
## Cardano Summary Statistics
```{r echo=FALSE, warning=FALSE}
stock = `ADA-USD`
# Get the column name of the adjusted price
stock.Adjusted.ColName = names(stock)[6]
# Get the stock adjusted values
stockAdj = stock[,stock.Adjusted.ColName]

stock.ADA <- stockAdj
summary(stock.ADA)
```


## Graphing the Time Series
The figures below show the time series for Coinbase  and Cardano (ADA-USD) since their inception in 2021 and 2017, respectively. While Cardano appears to be a multiplicative, non-stationary time series, Coinbase seem to be an additive time series.


```{r echo=FALSE, fig.align="center", fig.fullwidth=T, fig.height=3.75, warning=FALSE}
autoplot(stock.COIN) +
  ggtitle('Coinbase')

autoplot(stock.ADA) +
  ggtitle('Cardano ADA-USD')
```

In the figures below we can see both time series with a log transformation. The log transformation did not affect Coinbase much, confirming the additive nature. On the other hand, it has transformed Cardano's into a more stable form.
\newpage
```{r echo=TRUE, fig.align="center", fig.fullwidth=T, fig.height=3.75, warning=FALSE}
autoplot(log(stock.COIN)) +
  ggtitle('Coinbase "Log"')

autoplot(log(stock.ADA)) +
  ggtitle('Cardano ADA-USD "Log"')
```

The figures below, we can see the log returns. The plot shows general white noise in both tickers with a few outliers fro Cardano in late 2017 and early 2020. 


```{r echo=TRUE, fig.align="center", fig.fullwidth=T, fig.height=3.75, warning=FALSE}
autoplot(diff(log(stock.COIN))) +
  ggtitle('Coinbase "Log Returns"')

autoplot(diff(log(stock.ADA))) +
  ggtitle('Cardano ADA-USD "Log Returns"')

```
\newpage
## Auto-correlation

The ACF plots shows that Cardano's Auto-correlation has a strong presence in this time series. The ACF gradually decreases indicating a non-stationary series. Coinbase's ACF quickly decays indicating also indicating non-stationary series.

```{r echo=TRUE, fig.align="center", fig.fullwidth=T, fig.height=3.75, warning=FALSE}

acf(log(stock.COIN), na.action = na.pass)
acf(log(stock.ADA), na.action = na.pass)

```

\newpage

## Ljung Box Test

This can be further confirmed by performing the Ljung Box test. At lag 100, the Ljung-Box p-value is close to zero. This indicates that at the 99% confidence, the null hypothesis is rejected and one can conclude that the series is not independently distributed and exhibit serial correlation.

```{r echo=TRUE, warning=FALSE}

Box.test(log(stock.COIN), lag = 100, type = "Ljung-Box")
Box.test(log(stock.ADA), lag = 100, type = "Ljung-Box")
```
\newpage